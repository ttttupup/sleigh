<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>decompiler: MacroBuilder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">decompiler
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMacroBuilder-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MacroBuilder Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A class for expanding macro directives within a p-code section.  
 <a href="classMacroBuilder.html#details">More...</a></p>

<p><code>#include &lt;slgh_compile.hh&gt;</code></p>
<div class="dynheader">
Inheritance diagram for MacroBuilder:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMacroBuilder.png" usemap="#MacroBuilder_map" alt=""/>
  <map id="MacroBuilder_map" name="MacroBuilder_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a48f0c264b4f17a41459af1107729a457"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a48f0c264b4f17a41459af1107729a457"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#a48f0c264b4f17a41459af1107729a457">MacroBuilder</a> (<a class="el" href="classSleighCompile.html">SleighCompile</a> *sl, vector&lt; OpTpl * &gt; &amp;ovec, uint4 lbcnt)</td></tr>
<tr class="memdesc:a48f0c264b4f17a41459af1107729a457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. <br/></td></tr>
<tr class="separator:a48f0c264b4f17a41459af1107729a457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a394a95a6f96e016453a33734f132ae59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#a394a95a6f96e016453a33734f132ae59">setMacroOp</a> (OpTpl *macroop)</td></tr>
<tr class="memdesc:a394a95a6f96e016453a33734f132ae59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establish the MACRO directive to expand.  <a href="#a394a95a6f96e016453a33734f132ae59">More...</a><br/></td></tr>
<tr class="separator:a394a95a6f96e016453a33734f132ae59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97ed4caf433a734ebb99708ec76b4f51"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a97ed4caf433a734ebb99708ec76b4f51"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#a97ed4caf433a734ebb99708ec76b4f51">hasError</a> (void) const </td></tr>
<tr class="memdesc:a97ed4caf433a734ebb99708ec76b4f51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return <b>true</b> if there were errors during expansion. <br/></td></tr>
<tr class="separator:a97ed4caf433a734ebb99708ec76b4f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03bea914f6f63a779c6dd7c6d547c5d8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03bea914f6f63a779c6dd7c6d547c5d8"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>appendBuild</b> (OpTpl *bld, int4 secnum)</td></tr>
<tr class="separator:a03bea914f6f63a779c6dd7c6d547c5d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afadaa2541aeb61997f74b606c5cadf06"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afadaa2541aeb61997f74b606c5cadf06"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>delaySlot</b> (OpTpl *op)</td></tr>
<tr class="separator:afadaa2541aeb61997f74b606c5cadf06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ea6a3fd6be762cc3d05851e59b22b79"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5ea6a3fd6be762cc3d05851e59b22b79"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>setLabel</b> (OpTpl *op)</td></tr>
<tr class="separator:a5ea6a3fd6be762cc3d05851e59b22b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c903d7c450eb1f5a503e85c4f8218f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a82c903d7c450eb1f5a503e85c4f8218f"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>appendCrossBuild</b> (OpTpl *bld, int4 secnum)</td></tr>
<tr class="separator:a82c903d7c450eb1f5a503e85c4f8218f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa684d43d15777ebc7167099c69bf30d5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#aa684d43d15777ebc7167099c69bf30d5">transferOp</a> (OpTpl *op, vector&lt; HandleTpl * &gt; &amp;<a class="el" href="classMacroBuilder.html#a4412fa11a3334c1d4a765930071ae216">params</a>)</td></tr>
<tr class="memdesc:aa684d43d15777ebc7167099c69bf30d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a cloned OpTpl, substitute parameters and add to the output list.  <a href="#aa684d43d15777ebc7167099c69bf30d5">More...</a><br/></td></tr>
<tr class="separator:aa684d43d15777ebc7167099c69bf30d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47cdb43c7217f651b9b4e2651b388cf2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a47cdb43c7217f651b9b4e2651b388cf2"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>dump</b> (OpTpl *op)</td></tr>
<tr class="separator:a47cdb43c7217f651b9b4e2651b388cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e875ab27710223138d6b762369dff93"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5e875ab27710223138d6b762369dff93"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#a5e875ab27710223138d6b762369dff93">free</a> (void)</td></tr>
<tr class="memdesc:a5e875ab27710223138d6b762369dff93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free resources used by the builder. <br/></td></tr>
<tr class="separator:a5e875ab27710223138d6b762369dff93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc59b09f5904395df35e894bc1bfaf71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#afc59b09f5904395df35e894bc1bfaf71">reportError</a> (const Location *loc, const string &amp;val)</td></tr>
<tr class="memdesc:afc59b09f5904395df35e894bc1bfaf71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report error encountered expanding the macro.  <a href="#afc59b09f5904395df35e894bc1bfaf71">More...</a><br/></td></tr>
<tr class="separator:afc59b09f5904395df35e894bc1bfaf71"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6570d685d5978fbb63a7fc53bc514aea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6570d685d5978fbb63a7fc53bc514aea"></a>
<a class="el" href="classSleighCompile.html">SleighCompile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#a6570d685d5978fbb63a7fc53bc514aea">slgh</a></td></tr>
<tr class="memdesc:a6570d685d5978fbb63a7fc53bc514aea"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SLEIGH parsing object. <br/></td></tr>
<tr class="separator:a6570d685d5978fbb63a7fc53bc514aea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bddf48f0f72d307e0b97b55abfe384a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3bddf48f0f72d307e0b97b55abfe384a"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#a3bddf48f0f72d307e0b97b55abfe384a">haserror</a></td></tr>
<tr class="memdesc:a3bddf48f0f72d307e0b97b55abfe384a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set to <b>true</b> by the build() method if there was an error. <br/></td></tr>
<tr class="separator:a3bddf48f0f72d307e0b97b55abfe384a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a577761a6765f1340038a26c967e5c435"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a577761a6765f1340038a26c967e5c435"></a>
vector&lt; OpTpl * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#a577761a6765f1340038a26c967e5c435">outvec</a></td></tr>
<tr class="memdesc:a577761a6765f1340038a26c967e5c435"><td class="mdescLeft">&#160;</td><td class="mdescRight">The partial list of op templates to expand the macro into. <br/></td></tr>
<tr class="separator:a577761a6765f1340038a26c967e5c435"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4412fa11a3334c1d4a765930071ae216"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4412fa11a3334c1d4a765930071ae216"></a>
vector&lt; HandleTpl * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMacroBuilder.html#a4412fa11a3334c1d4a765930071ae216">params</a></td></tr>
<tr class="memdesc:a4412fa11a3334c1d4a765930071ae216"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of parameters to substitute into the macro. <br/></td></tr>
<tr class="separator:a4412fa11a3334c1d4a765930071ae216"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class for expanding macro directives within a p-code section. </p>
<p>It is handed a (partial) list of p-code op templates (OpTpl). The macro directive is established with the <a class="el" href="classMacroBuilder.html#a394a95a6f96e016453a33734f132ae59" title="Establish the MACRO directive to expand. ">setMacroOp()</a> method. Then calling build() expands the macro into the list of OpTpls, providing parameter substitution. The class is derived from PcodeBuilder, where the dump() method, instead of emitting raw p-code, clones the macro templates into the list of OpTpls. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="afc59b09f5904395df35e894bc1bfaf71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MacroBuilder::reportError </td>
          <td>(</td>
          <td class="paramtype">const Location *&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Report error encountered expanding the macro. </p>
<p>The error is passed up to the main parse object and a note is made locally that an error occurred so parsing can be terminated immediately. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">loc</td><td>is the parse location where the error occurred </td></tr>
    <tr><td class="paramname">val</td><td>is the error message </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classMacroBuilder.html#a3bddf48f0f72d307e0b97b55abfe384a">haserror</a>, and <a class="el" href="classSleighCompile.html#a540e67ad21bcad4153d910a5fe857e77">SleighCompile::reportError()</a>.</p>

<p>Referenced by <a class="el" href="classMacroBuilder.html#aa684d43d15777ebc7167099c69bf30d5">transferOp()</a>.</p>

</div>
</div>
<a class="anchor" id="a394a95a6f96e016453a33734f132ae59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MacroBuilder::setMacroOp </td>
          <td>(</td>
          <td class="paramtype">OpTpl *&#160;</td>
          <td class="paramname"><em>macroop</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establish the MACRO directive to expand. </p>
<p>Given the op corresponding to the invocation, set up the specific parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">macroop</td><td>is the given MACRO directive op </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classMacroBuilder.html#a5e875ab27710223138d6b762369dff93">free()</a>, and <a class="el" href="classMacroBuilder.html#a4412fa11a3334c1d4a765930071ae216">params</a>.</p>

<p>Referenced by <a class="el" href="classSleighCompile.html#a5bf01c88c3bbcef213634275947f7040">SleighCompile::expandMacros()</a>.</p>

</div>
</div>
<a class="anchor" id="aa684d43d15777ebc7167099c69bf30d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MacroBuilder::transferOp </td>
          <td>(</td>
          <td class="paramtype">OpTpl *&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; HandleTpl * &gt; &amp;&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Given a cloned OpTpl, substitute parameters and add to the output list. </p>
<p>VarnodesTpls used by the op are examined to see if they are derived from parameters of the macro. If so, details of the parameters actively passed as part of the specific macro invocation are substituted into the VarnodeTpl. Truncation operations on a macro parameter may cause additional CPUI_SUBPIECE operators to be inserted as part of the expansion and certain forms are not permitted. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>is the cloned op to emit </td></tr>
    <tr><td class="paramname">params</td><td>is the set of parameters specific to the macro invocation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><b>true</b> if there are no illegal truncations </dd></dl>

<p>References <a class="el" href="opcodes_8hh.html#abeb7dfb0e9e2b3114e240a405d046ea7a2f366ca905ed81c22e500d5de37de366">CPUI_SUBPIECE</a>, <a class="el" href="classAddrSpaceManager.html#a8e1a7314a41ca6854f5c7d19c69acf18">AddrSpaceManager::getConstantSpace()</a>, <a class="el" href="classSleighCompile.html#abe9c40bc007409e4091be3b0ed5db636">SleighCompile::getUniqueAddr()</a>, <a class="el" href="classAddrSpaceManager.html#a3bef0bbef7bfe26c2790ec6018d8fc02">AddrSpaceManager::getUniqueSpace()</a>, <a class="el" href="classMacroBuilder.html#a577761a6765f1340038a26c967e5c435">outvec</a>, and <a class="el" href="classMacroBuilder.html#afc59b09f5904395df35e894bc1bfaf71">reportError()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="slgh__compile_8hh.html">slgh_compile.hh</a></li>
<li>slgh_compile.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
